<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>나이스 월별계획 자동입력</title>
  <link rel="stylesheet" href="popup.css">
</head>
<body>
  <div class="container">
    <!-- 헤더 -->
    <header class="header">
      <h1>📚 나이스 월별계획 자동입력</h1>
      <p class="version">v1.0.0</p>
      <button id="toggleAdvanced" class="btn-link" style="margin-left: auto;">⚙️ 고급 설정 보기</button>
    </header>

    <!-- 연결 상태 -->
    <div class="connection-status hidden" id="connectionStatus">
      <div class="status-indicator" id="statusIndicator"></div>
      <span id="statusText">연결 확인 중...</span>
    </div>

    <!-- 웹사이트 연동 섹션 -->
    <section class="section hidden" id="websiteConnectionSection">
      <h2>🔗 웹사이트 연동</h2>
      <div class="form-group">
        <label for="websiteUrl">웹사이트 URL</label>
        <input 
          type="text" 
          id="websiteUrl" 
          placeholder="https://www.iepon.site"
          value=""
        />
        <button id="testConnection" class="btn btn-secondary">연결 테스트</button>
      </div>

      <div class="form-group">
        <label for="apiKey">API 키 (선택사항)</label>
        <input 
          type="password" 
          id="apiKey" 
          placeholder="Supabase API Key"
        />
      </div>

      <button id="saveSettings" class="btn btn-primary">설정 저장</button>
    </section>

    <!-- 데이터 입력 방식 선택 -->
    <section class="section hidden" id="inputMethodSection">
      <h2>📋 데이터 입력 방식</h2>
      <div class="radio-group">
        <label class="radio-label">
          <input type="radio" name="inputMethod" value="website">
          <span>웹사이트에서 가져오기</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="inputMethod" value="manual">
          <span>직접 입력</span>
        </label>
        <label class="radio-label">
          <input type="radio" name="inputMethod" value="json" checked>
          <span>JSON 붙여넣기</span>
        </label>
      </div>
    </section>

    <!-- 웹사이트 데이터 섹션 -->
    <section class="section hidden" id="websiteDataSection">
      <h2>👤 학생 선택</h2>
      <div class="form-group">
        <select id="studentSelect" class="select-box">
          <option value="">학생을 선택하세요</option>
        </select>
        <button id="loadStudents" class="btn btn-secondary">학생 목록 불러오기</button>
      </div>

      <div class="form-group">
        <label for="studentName">선택 학생 이름</label>
        <input
          type="text"
          id="studentName"
          placeholder="예: 곽하윤"
        />
      </div>

      <div class="form-group">
        <label>📅 학년도/학기</label>
        <div class="inline-group">
          <input type="text" id="year" placeholder="2024" class="input-small" />
          <select id="semester" class="select-small">
            <option value="1">1학기</option>
            <option value="2">2학기</option>
          </select>
        </div>
      </div>

      <div class="form-group">
        <label>🏫 학년/반/번호</label>
        <div class="inline-group">
          <select id="grade" class="select-small">
            <option value="">학년</option>
            <option value="1">1학년</option>
            <option value="2">2학년</option>
            <option value="3">3학년</option>
            <option value="4">4학년</option>
            <option value="5">5학년</option>
            <option value="6">6학년</option>
          </select>
          <input type="text" id="className" placeholder="반" class="input-small" />
          <input type="text" id="studentNumber" placeholder="번호" class="input-small" />
        </div>
      </div>

      <div class="form-group">
        <label for="inputType">🗂️ 입력구분</label>
        <select id="inputType" class="select-box">
          <option value="">선택하세요</option>
          <option value="교과영역">교과영역</option>
          <option value="생활지원영역">생활지원영역</option>
        </select>
      </div>

      <div class="form-group">
        <label for="subject">📘 영역</label>
        <input
          type="text"
          id="subject"
          placeholder="예: 국어"
        />
      </div>

      <button id="fetchData" class="btn btn-primary">데이터 가져오기</button>
    </section>

    <!-- 수동 입력 섹션 -->
    <section class="section hidden" id="manualInputSection">
      <h2>✏️ 수동 입력</h2>
      <div class="form-group">
        <label for="manualMonth">월</label>
        <input type="text" id="manualMonth" placeholder="예: 3 또는 3,4,5" />
      </div>
      <div class="form-group">
        <label for="manualGoal">교육목표</label>
        <textarea id="manualGoal" rows="3" placeholder="교육목표를 입력하세요"></textarea>
      </div>
      <div class="form-group">
        <label for="manualContent">교육내용</label>
        <textarea id="manualContent" rows="3" placeholder="교육내용을 입력하세요"></textarea>
      </div>
      <div class="form-group">
        <label for="manualMethod">교육방법</label>
        <textarea id="manualMethod" rows="3" placeholder="교육방법을 입력하세요"></textarea>
      </div>
      <div class="form-group">
        <label for="manualEvaluation">평가계획</label>
        <textarea id="manualEvaluation" rows="3" placeholder="평가계획을 입력하세요"></textarea>
      </div>
      <button id="addManualData" class="btn btn-primary">데이터 추가</button>
    </section>

    <!-- JSON 입력 섹션 -->
    <section class="section" id="jsonInputSection">
      <h2>📄 JSON 데이터 입력</h2>
      <div class="form-group">
        <textarea 
          id="jsonData" 
          rows="10" 
          placeholder='[
  {
    "month": "3",
    "goal": "교육목표",
    "content": "교육내용",
    "method": "교육방법",
    "evaluation": "평가계획"
  }
]'></textarea>
      </div>
      <button id="parseJson" class="btn btn-primary">JSON 파싱</button>
    </section>

    <!-- 데이터 미리보기 -->
    <section class="section" id="previewSection">
      <h2>📝 입력할 데이터 미리보기</h2>
      <div id="dataPreview" class="data-preview">
        <p class="empty-state">데이터를 가져오거나 입력하세요</p>
      </div>
      <div class="preview-actions hidden" id="previewActions">
        <button id="clearData" class="btn btn-secondary">전체 삭제</button>
        <span id="dataCount" class="data-count">0개 항목</span>
      </div>
    </section>

    <!-- 실행 버튼 -->
    <section class="section">
      <button id="startAutoFill" class="btn btn-primary btn-large" disabled>
        🚀 자동 입력 시작
      </button>
      <div class="progress-container hidden" id="progressContainer">
        <div class="progress-bar">
          <div class="progress-fill" id="progressFill"></div>
        </div>
        <p class="progress-text" id="progressText">0 / 0 완료</p>
      </div>
    </section>

    <!-- 로그 -->
    <section class="section">
      <details>
        <summary>📋 실행 로그</summary>
        <div id="logContainer" class="log-container">
          <p class="log-empty">로그가 없습니다</p>
        </div>
      </details>
    </section>

    <!-- 푸터 -->
    <footer class="footer">
      <button id="openSettings" class="btn-link">⚙️ 설정</button>
      <button id="openHelp" class="btn-link">📖 도움말</button>
      <button id="openAbout" class="btn-link">ℹ️ 정보</button>
    </footer>
  </div>

  <script src="popup.js"></script>
</body>
</html>
